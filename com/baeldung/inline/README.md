# Java Inline Method (JIT Compiler)
- [1. What is method inlining?](#1-what-is-method-inlining)
- [2. How to find inline methods](#2-how-to-find-inline-methods)
- [3. Example](#3-example) 

---
## 1. What is method inlining?
> Basically, inlining is a way to optimize compiled source code at runtime by replacing the invocations of the most often executed methods with its bodies.<br/><br/>
> Although there's compilation involved, it's not performed by the traditional javac compiler, but by the JVM itself. To be more precise, it's the responsibility of the Just-In-Time (JIT) compiler, which is a part of the JVM; javac only produces a bytecode and lets JIT do the magic and optimize the source code.<br/><br/>
> One of the most important consequences of this approach is that if we compile the code using old Java, the same .class file will be faster on newer JVMs. This way we don’t need to recompile the source code, but only update Java.<br/><br/>
> The JIT inlines static, private, or final methods in general. And while public methods are also candidates for inlining, not every public method will necessarily be inlined. The JVM needs to determine that there's only a single implementation of such a method.

## 2. How to find inline methods
### JVM Option to find what JIT is doing
```bash
-XX:+PrintCompilation -XX:+UnlockDiagnosticVMOptions -XX:+PrintInlining
```

- **_inline (hot)_** - this method is marked as hot and is inlined
- **_too big_** – the method is not hot, but also its generated bytecode is too big, so it’s not inlined
- **_hot method too big_** – this is a hot method, but it's not inlined since the bytecode is too big

## 3. Example
```java
package com.baeldung.inline;

public class ConsecutiveNumbersSum {
    private final int totalNumbers;

    public ConsecutiveNumbersSum(int totalNumbers) {
        this.totalNumbers = totalNumbers;
    }

    public long getTotalSum() {
        long totalSum = 0;
        for (int i = 0; i < totalNumbers; i++) {
            totalSum += i;
        }
        return totalSum;
    }
}
```

```java
package com.baeldung.inline;

public class InlineMethodExample {

    public static final int NUMBERS_OF_ITERATIONS = 10000;  // 5000, 10000, 15000

    public static void main(String[] args) {
        for (int i = 1; i < NUMBERS_OF_ITERATIONS; i++) {
            calculateSum(i);
        }
    }

    private static long calculateSum(int n) {
        return new ConsecutiveNumbersSum(n).getTotalSum();
    }
}
```

```text
    127    1       3       java.lang.Object::<init> (1 bytes)
    127    3       3       java.lang.Math::min (11 bytes)
    127    2       1       sun.instrument.TransformerManager::getSnapshotTransformerList (5 bytes)
    128    4       3       java.lang.String::hashCode (55 bytes)
    129    5       4       java.lang.String::charAt (29 bytes)
    129    6       3       java.lang.System::getSecurityManager (4 bytes)
    129    7       3       java.lang.String::startsWith (7 bytes)
                              @ 3   java.lang.String::startsWith (72 bytes)   callee is too large
    130    8       3       sun.nio.cs.UTF_8$Encoder::encode (359 bytes)
                              @ 14   java.lang.Math::min (11 bytes)
                              @ 139   java.lang.Character::isSurrogate (18 bytes)
                 130    9     n 0       java.lang.System::arraycopy (native)   (static)
                 @ 157  sun/nio/cs/Surrogate$Parser::<init> (not loaded)   not inlineable
                              @ 175  sun/nio/cs/Surrogate$Parser::parse (not loaded)   not inlineable
                              @ 186   java.nio.charset.CharsetEncoder::malformedInputAction (5 bytes)
    131   11       3       java.lang.String::<init> (82 bytes)
                              @ 1   java.lang.Object::<init> (1 bytes)
                              @ 13  java/lang/StringIndexOutOfBoundsException::<init> (not loaded)   not inlineable
                              @ 30  java/lang/StringIndexOutOfBoundsException::<init> (not loaded)   not inlineable
                              @ 65  java/lang/StringIndexOutOfBoundsException::<init> (not loaded)   not inlineable
                              @ 75   java.util.Arrays::copyOfRange (63 bytes)   callee is too large
    132   13       3       java.io.UnixFileSystem::normalize (75 bytes)
                              @ 1   java.lang.String::length (6 bytes)
                              @ 19   java.lang.String::charAt (29 bytes)
                                @ 18  java/lang/StringIndexOutOfBoundsException::<init> (not loaded)   not inlineable
                              @ 44   java.io.UnixFileSystem::normalize (132 bytes)   callee is too large
                              @ 69   java.io.UnixFileSystem::normalize (132 bytes)   callee is too large
    132   14       3       java.lang.String::equals (81 bytes)
    133   10       3       java.util.Arrays::copyOf (19 bytes)
                              @ 11   java.lang.Math::min (11 bytes)
                              @ 14   java.lang.System::arraycopy (0 bytes)   intrinsic
    133   16       3       java.lang.String::indexOf (70 bytes)
                              @ 66   java.lang.String::indexOfSupplementary (71 bytes)   callee is too large
    133   15       3       java.lang.String::length (6 bytes)
    133   12       1       java.net.URL::getHost (5 bytes)
    134   17       3       com.baeldung.inline.ConsecutiveNumbersSum::getTotalSum (25 bytes)
    134   18       3       com.baeldung.inline.InlineMethodExample::calculateSum (12 bytes)
    134   21 %     4       com.baeldung.inline.ConsecutiveNumbersSum::getTotalSum @ 4 (25 bytes)
                              @ 5   com.baeldung.inline.ConsecutiveNumbersSum::<init> (10 bytes)
                                @ 1   java.lang.Object::<init> (1 bytes)
                              @ 8   com.baeldung.inline.ConsecutiveNumbersSum::getTotalSum (25 bytes)
    134   23       1       java.lang.Object::<init> (1 bytes)
    134    1       3       java.lang.Object::<init> (1 bytes)   made not entrant
    134   22       3       java.lang.String::indexOf (7 bytes)
                              @ 3   java.lang.String::indexOf (70 bytes)   callee is too large
    135   19       3       com.baeldung.inline.ConsecutiveNumbersSum::<init> (10 bytes)
                              @ 1   java.lang.Object::<init> (1 bytes)
    135   20       3       java.util.BitSet::wordIndex (5 bytes)
    136   18       3       com.baeldung.inline.InlineMethodExample::calculateSum (12 bytes)   made not entrant
    137   24       3       com.baeldung.inline.InlineMethodExample::calculateSum (12 bytes)
                              @ 5   com.baeldung.inline.ConsecutiveNumbersSum::<init> (10 bytes)
                                @ 1   java.lang.Object::<init> (1 bytes)
                              @ 8   com.baeldung.inline.ConsecutiveNumbersSum::getTotalSum (25 bytes)   inlining prohibited by policy
    137   25       4       com.baeldung.inline.ConsecutiveNumbersSum::getTotalSum (25 bytes)
    138   17       3       com.baeldung.inline.ConsecutiveNumbersSum::getTotalSum (25 bytes)   made not entrant
    145   26       4       com.baeldung.inline.InlineMethodExample::calculateSum (12 bytes)
                              @ 5   com.baeldung.inline.ConsecutiveNumbersSum::<init> (10 bytes)   inline (hot)
                                @ 1   java.lang.Object::<init> (1 bytes)   inline (hot)
                              @ 8   com.baeldung.inline.ConsecutiveNumbersSum::getTotalSum (25 bytes)   inline (hot)
    147   24       3       com.baeldung.inline.InlineMethodExample::calculateSum (12 bytes)   made not entrant
    160   27     n 0       java.lang.Thread::currentThread (native)   (static)

Process finished with exit code 0
```